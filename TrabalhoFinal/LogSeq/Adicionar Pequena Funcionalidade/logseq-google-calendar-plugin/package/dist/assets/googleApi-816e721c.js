import{_ as d}from"./index-3d77c527.js";const i="https://www.googleapis.com/calendar/v3";function p(t){const o=t.id||void 0,n=t.recurringEventId||void 0,a=t.summary||"(no title)",r=t.start,e=t.end,s=r&&(r.dateTime||r.date)||"",m=e&&(e.dateTime||e.date)||void 0,u=t.description||void 0;return{id:o,recurringEventId:n,title:a,start:s,end:m,description:u}}async function c(t,o={}){const a=await(await d(()=>import("./googleAuth-1192cdea.js"),[],import.meta.url)).getAccessToken();if(!a)throw new Error("No access token available");const r=Object.assign({},o.headers||{},{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}),e=await fetch(t,Object.assign({},o,{headers:r}));if(!e.ok){const s=await e.text();throw new Error(`Google API error ${e.status}: ${s}`)}return e.json()}async function w(t="primary",o){const n=new URL(`${i}/calendars/${encodeURIComponent(t)}/events`);return o&&n.searchParams.set("timeMin",o),n.searchParams.set("singleEvents","true"),n.searchParams.set("orderBy","startTime"),((await c(n.toString())).items||[]).map(p)}async function h(t,o="primary"){if(t.id){const r=`${i}/calendars/${encodeURIComponent(o)}/events/${encodeURIComponent(t.id)}`,e={summary:t.title,description:t.description,start:{dateTime:t.start},end:t.end?{dateTime:t.end}:void 0};return await c(r,{method:"PATCH",body:JSON.stringify(e)})}const n=`${i}/calendars/${encodeURIComponent(o)}/events`,a={summary:t.title,description:t.description,start:{dateTime:t.start},end:t.end?{dateTime:t.end}:void 0};return await c(n,{method:"POST",body:JSON.stringify(a)})}async function y(t,o="primary"){const n=`${i}/calendars/${encodeURIComponent(o)}/events/${encodeURIComponent(t)}`,r=await(await d(()=>import("./googleAuth-1192cdea.js"),[],import.meta.url)).getAccessToken();if(!r)throw new Error("No access token available");const e=await fetch(n,{method:"DELETE",headers:{Authorization:`Bearer ${r}`}});if(!e.ok){const s=await e.text();throw new Error(`Google API delete error ${e.status}: ${s}`)}return!0}export{h as createOrUpdateEvent,y as deleteEvent,w as listEvents};
